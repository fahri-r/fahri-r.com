---
import Layout from '~/layouts/layout.astro';
import ProjectCard from '~/components/projects/project-card.astro';
import { getCollection } from 'astro:content';

const BLOG_PATH = 'blog';
const TITLE = 'Blog';
const DESCRIPTION = 'Writing on topics I am passionate about.';

const posts = await getCollection('blog');
---

<Layout title={TITLE} description={DESCRIPTION}>
	<main class="">
		<h1 class="font-sans text-xl font-bold">{TITLE}</h1>
		<p class="text-muted-foreground mb-4 text-sm leading-relaxed">
			{DESCRIPTION}
		</p>

		<div class="mx-auto grid max-w-[800px] grid-cols-1 gap-3 sm:grid-cols-2">
			{
				posts
					.sort((postA, postB) => {
						const aDate = new Date(postA.data.date);
						const bDate = new Date(postB.data.date);
						return bDate.getTime() - aDate.getTime();
					})
					.map(async (post) => {
						const { cover, title, date, slug, tools, description } = post.data;
						const href = `/${BLOG_PATH}/${slug}`;
						const dateStr = new Date(date).toLocaleString('en-US', {
							month: 'short',
							day: 'numeric',
							year: 'numeric'
						});

						return <ProjectCard {href} {cover} {title} {tools} {description} date={dateStr} />;
					})
			}
		</div>
	</main>
</Layout>

---
import Layout from '~/layouts/layout.astro';
import ProjectCard from '~/components/projects/project-card.astro';
import { getCollection } from 'astro:content';

const PROJECTS_PATH = 'projects';
const TITLE = 'Projects';
const DESCRIPTION = 'Several projects that I have worked on, both private and open source.';

const projects = await getCollection('projects');
---

<Layout title={TITLE} description={DESCRIPTION}>
	<main class="">
		<h1 class="font-sans text-xl font-bold">{TITLE}</h1>
		<p class="text-muted-foreground mb-4 text-sm leading-relaxed">
			{DESCRIPTION}
		</p>

		<div class="mx-auto grid max-w-[800px] grid-cols-1 gap-3 sm:grid-cols-2">
			{
				projects
					.sort((projectA, projectB) => {
						const aDate = new Date(projectA.data.date);
						const bDate = new Date(projectB.data.date);
						return bDate.getTime() - aDate.getTime();
					})
					.map(async (project) => {
						const { cover, title, date, slug, tools, description } = project.data;
						const href = `/${PROJECTS_PATH}/${slug}`;
						const dateStr = new Date(date).toLocaleString('en-US', {
							month: 'short',
							day: 'numeric',
							year: 'numeric'
						});

						return <ProjectCard {href} {cover} {title} {tools} {description} date={dateStr} />;
					})
			}
		</div>
	</main>
</Layout>
